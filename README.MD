# GenAI-Powered Code Reviewer Bot for OpenMP

Python-first prototype of a Clang-compatible CLI tool that analyzes OpenMP-related pull requests and suggests review comments using GenAI, trained on historical GitHub data.

## Dependencies

Install the required Python packages:

```bash
pip install -r requirements.txt
```

## Environment Setup

Create a `.env` file in the project root with your GitHub token:

```env
GITHUB_TOKEN=ghp_your_personal_access_token_here
GEMINI_API_KEY=your_gemini_api_key
```

> Make sure your token has at least `read:public_repo` or `repo` scope.

---

## File Structure

```bash
.
â”œâ”€â”€ .env
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ run_preprocessing.sh
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ openmp_prs.json
â”‚   â”œâ”€â”€ openmp_hunks_comments.json
â”‚   â”œâ”€â”€ prs_with_review_comments.json
â”‚   â”œâ”€â”€ mapping_stats.json
â”‚   â”œâ”€â”€ faiss_index.idx
â”‚   â””â”€â”€ comments_lookup.json
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ collect_data.py
â”‚   â”œâ”€â”€ find_comments.py
â”‚   â”œâ”€â”€ preprocess_data.py
â”‚   â”œâ”€â”€ analyze_mappings.py
â”‚   â”œâ”€â”€ build_vector_db.py
â”‚   â”œâ”€â”€ diff_utils.py
â”‚   â””â”€â”€ suggest_code_review.py

```

## Project Workflow

### 1. Find PRs with Review Comments

```bash
python src/find_comments.py
```

**Output:** `data/prs_with_review_comments.json`


### 2. Collect PR Data (Diffs + Comments)

```bash
python src/collect_data.py
```

**Output:** `data/openmp_prs.json`


### 3. Map Comments to Code Hunks

```bash
python src/preprocess_data.py
```

**Output:** `data/openmp_hunks_comments.json`


### 4. Analyze Mappings & Generate Stats

```bash
python src/analyze_mappings.py
```

**Output:**

* Summary in terminal
* `data/mapping_stats.json`


### 5. Build a Vector Store

```bash
python src/build_vector_dbs.py
```

**Output:**

* `data/comments_lookup.json`
* `faiss_index.idx`


### 6. Suggest Code Review Comments

```bash
python src/suggest_code_review.py <pr#>
```

**Dummy Output:**
 ```
ğŸ“¥ Fetching hunks for PR #98547 
ğŸ” Hunk from clang/include/clang/Parse/Parser.h, line 3368
ğŸ’¬ Suggested Comment:
The addition of `TildeLoc` is good for parsing correctness. However, could you add a brief comment explaining the purpose of `TildeLoc` for better understanding in the future?
```

## Output File Description

| File                            | Description                             |
| ------------------------------- | --------------------------------------- |
| `openmp_prs.json`               | Raw PRs with review + issue comments    |
| `openmp_hunks_comments.json`    | Comments mapped to file hunks           |
| `mapping_stats.json`            | Summary of comment stats                |
| `prs_with_review_comments.json` | PRs filtered to contain inline comments |
| `comments_lookup.json`          | store queries and comments for lookup   |
| `faiss_index.idx`               | generated FAISS vector index            |
